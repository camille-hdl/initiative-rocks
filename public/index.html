<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="x-ua-compatible" content="ie=edge" />
        <title>Rollup React example</title>
        <meta name="viewport" content="minimum-scale=1, initial-scale=1, width=device-width, shrink-to-fit=no" />
    </head>
    <body>
        <script type="module">
            (function() {
                if (navigator && navigator.serviceWorker) {
                    window.addEventListener("load", () => {
                        navigator.serviceWorker.register("/js/esm/sw.js", { scope: "/" });
                    });
                }
                window.esDynamicImport = true;
                // this will throw if dynamic import is not supported
                import("/js/esm/index.js");
            })();
        </script>

        <!-- browsers with ES6 modules but no dynamic import support -->
        <script type="module">
            // if the module script tag throws, window.esDynamicImport will be undefined
            if (!window.esDynamicImport) {
                // get the nomodule scripts and load (or inline) them
                const noms = Array.prototype.slice
                    .call(document.getElementsByTagName("script"), 0)
                    .filter(x => x.hasAttribute("nomodule"));
                function nextLoad(nom, s) {
                    if (!(nom = noms.shift())) return;
                    s = document.createElement("script");
                    if (nom.src)
                        (s.src = nom.src), s.addEventListener("load", nextLoad), s.addEventListener("error", nextLoad);
                    else s.innerHTML = nom.innerHTML;
                    document.head.appendChild(s);
                    if (!nom.src) nextLoad();
                }
                nextLoad();
            }
        </script>

        <!-- No ES6 modules support : fallback to systemJS -->
        <script nomodule src="https://unpkg.com/systemjs@0.21.0/dist/system-production.js"></script>
        <script nomodule>
            if (navigator && navigator.serviceWorker) {
                window.addEventListener("load", () => {
                    navigator.serviceWorker.register("/js/system/sw.js", { scope: "/" });
                });
            }
            System.import("/js/system/index.js");
        </script>
        <div id="app-container"></div>
    </body>
</html>