<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="x-ua-compatible" content="ie=edge" />
        <title>Initiative Rocks!</title>
        <meta name="viewport" content="minimum-scale=1, initial-scale=1, width=device-width, shrink-to-fit=no" />
        <link href="https://fonts.googleapis.com/css?family=Rock+Salt" rel="stylesheet">
        <link rel="manifest" href="/manifest.json">
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
        <link rel="apple-touch-icon" href="apple-touch-icon.png">
        <link rel="icon" type="image/png" href="/favicon.png" />
        <script>
            window.__TRACKING_CONSENT_COOKIE_NAME__ = "myAnalytics_consent";
        
            window.myAnalytics || (window.myAnalytics = []);
            window.myAnalytics.methods = ['page', 'pageView', 'event'];
            window.myAnalytics.factory = function(method) {
                return function() {
                    var args = Array.prototype.slice.call(arguments);
                    args.unshift(method);
                    window.myAnalytics.push(args);
                    return window.myAnalytics;
                };
            };
            for (var i = 0; i < window.myAnalytics.methods.length; i++) {
                var method = window.myAnalytics.methods[i];
                window.myAnalytics[method] = window.myAnalytics.factory(method);
            }
        </script>
        <script>
            if (window.myAnalytics) {
                window.myAnalytics.page();
                window.myAnalytics.pageView();
            }
        </script>
    </head>
    <body>
        <script type="module">
            (function() {
                if (navigator && navigator.serviceWorker) {
                    window.addEventListener("load", () => {
                        navigator.serviceWorker.register("/js/esm/sw.js", { scope: "/" });
                    });
                }
                window.esDynamicImport = true;
                // this will throw if dynamic import is not supported
                import("/js/esm/index.js");
            })();
        </script>

        <!-- browsers with ES6 modules but no dynamic import support -->
        <script type="module">
            // if the module script tag throws, window.esDynamicImport will be undefined
            if (!window.esDynamicImport) {
                // get the nomodule scripts and load (or inline) them
                const noms = Array.prototype.slice
                    .call(document.getElementsByTagName("script"), 0)
                    .filter(x => x.hasAttribute("nomodule"));
                function nextLoad(nom, s) {
                    if (!(nom = noms.shift())) return;
                    s = document.createElement("script");
                    if (nom.src)
                        (s.src = nom.src), s.addEventListener("load", nextLoad), s.addEventListener("error", nextLoad);
                    else s.innerHTML = nom.innerHTML;
                    document.head.appendChild(s);
                    if (!nom.src) nextLoad();
                }
                nextLoad();
            }
        </script>

        <!-- No ES6 modules support : fallback to systemJS -->
        <script nomodule src="https://unpkg.com/systemjs@0.21.0/dist/system-production.js"></script>
        <script nomodule>
            if (navigator && navigator.serviceWorker) {
                window.addEventListener("load", () => {
                    navigator.serviceWorker.register("/js/system/sw.js", { scope: "/" });
                });
            }
            System.import("/js/system/index.js");
        </script>
        <div id="app-container"></div>
    </body>
</html>